import{r as E,A as f,c as o,d as n,e as x,f as a,u as y,t as i,q as S,l as m,g as v,v as w,F as h,h as C,n as c}from"./app-dlXwsprq.js";import{u as O,d as N}from"./vue-flow-core-CslHATJU.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"transform-node-content"},q={class:"transform-node-header"},D={class:"transform-node-label"},I=["title"],L={key:0,class:"transform-node-settings"},M={class:"setting-group"},W={class:"setting-option"},z=["value"],A={class:"setting-group"},H={class:"setting-option"},P=["value"],G={key:0,class:"setting-group"},K={class:"setting-option"},Q={key:1,class:"setting-group"},X={class:"setting-option"},Y={class:"setting-group"},Z={class:"setting-option"},_={key:1,class:"transform-node-summary"},tt={class:"transform-flow"},et={class:"transform-input"},at={class:"transform-type"},st={class:"transform-output"},ot={key:0,class:"transform-details"},nt={key:1,class:"transform-details"},lt={__name:"TransformNode",props:{id:{type:String,required:!0},data:{type:Object,required:!0},selected:{type:Boolean,default:!1},isConnectable:{type:Boolean,default:!0}},setup(s){const d=s,{findNode:V,setNodes:k,getNodes:T}=O(),r=E({showSettings:!1,transformations:[{value:"json_parse",label:"Parse JSON"},{value:"json_stringify",label:"Stringify JSON"},{value:"to_uppercase",label:"To Uppercase"},{value:"to_lowercase",label:"To Lowercase"},{value:"trim",label:"Trim Whitespace"},{value:"extract_text",label:"Extract Text (Regex)"},{value:"custom_code",label:"Custom JavaScript"}]}),U=f(()=>{const l=T.value,t=[];return l.forEach(e=>{e.data&&(e.data.type==="input"&&e.data.variable&&t.push(e.data.variable),e.data.type==="prompt"&&e.data.output_variable&&t.push(e.data.output_variable),e.data.type==="api"&&e.data.output_variable&&t.push(e.data.output_variable),e.data.type==="transform"&&e.data.output_variable&&e.id!==d.id&&t.push(e.data.output_variable))}),[...new Set(t)]}),$=()=>{r.value.showSettings=!r.value.showSettings},u=(l,t)=>{const e=V(d.id);if(!e)return;const F={...e,data:{...e.data,[l]:t}};k(J=>J.map(b=>b.id===d.id?F:b))},B=l=>r.value.transformations.find(e=>e.value===l)||{value:l,label:l},g=f(()=>d.data.transformation==="extract_text"),p=f(()=>d.data.transformation==="custom_code");return(l,t)=>(n(),o("div",{class:S(["transform-node",{selected:s.selected}])},[x(y(N),{type:"target",position:"top",id:s.id+"-target",connectable:s.isConnectable},null,8,["id","connectable"]),x(y(N),{type:"source",position:"bottom",id:s.id+"-source",connectable:s.isConnectable},null,8,["id","connectable"]),a("div",j,[a("div",q,[t[10]||(t[10]=a("i",{class:"fa fa-exchange-alt text-secondary me-1"},null,-1)),a("span",D,i(s.data.label),1),a("button",{type:"button",class:"transform-node-toggle",onClick:$,title:r.value.showSettings?"Hide settings":"Show settings"},[a("i",{class:S(["fa",r.value.showSettings?"fa-chevron-up":"fa-chevron-down"])},null,2)],8,I)]),r.value.showSettings?(n(),o("div",L,[a("div",M,[t[12]||(t[12]=a("label",{class:"setting-label"},"Input Variable",-1)),a("div",W,[v(a("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[0]||(t[0]=e=>s.data.input_variable=e),onChange:t[1]||(t[1]=e=>u("input_variable",s.data.input_variable))},[t[11]||(t[11]=a("option",{value:""},"Select input variable",-1)),(n(!0),o(h,null,C(U.value,e=>(n(),o("option",{key:e,value:e},i(e),9,z))),128))],544),[[w,s.data.input_variable]])]),t[13]||(t[13]=a("div",{class:"setting-help"},"Select the variable to transform",-1))]),a("div",A,[t[14]||(t[14]=a("label",{class:"setting-label"},"Transformation",-1)),a("div",H,[v(a("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[2]||(t[2]=e=>s.data.transformation=e),onChange:t[3]||(t[3]=e=>u("transformation",s.data.transformation))},[(n(!0),o(h,null,C(r.value.transformations,e=>(n(),o("option",{key:e.value,value:e.value},i(e.label),9,P))),128))],544),[[w,s.data.transformation]])])]),g.value?(n(),o("div",G,[t[15]||(t[15]=a("label",{class:"setting-label"},"Regular Expression",-1)),a("div",K,[v(a("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":t[4]||(t[4]=e=>s.data.regex=e),placeholder:"e.g., /pattern(.*?)pattern/i",onChange:t[5]||(t[5]=e=>u("regex",s.data.regex))},null,544),[[c,s.data.regex]])]),t[16]||(t[16]=a("div",{class:"setting-help"},"Use a capture group () to extract specific text",-1))])):m("",!0),p.value?(n(),o("div",Q,[t[17]||(t[17]=a("label",{class:"setting-label"},"Custom JavaScript",-1)),a("div",X,[v(a("textarea",{class:"form-control form-control-sm","onUpdate:modelValue":t[6]||(t[6]=e=>s.data.code=e),rows:"4",placeholder:`// input contains the variable value
// return the transformed result
return input.toString();`,onChange:t[7]||(t[7]=e=>u("code",s.data.code))},null,544),[[c,s.data.code]])]),t[18]||(t[18]=a("div",{class:"setting-help"},"Write JavaScript code to transform the input value",-1))])):m("",!0),a("div",Y,[t[19]||(t[19]=a("label",{class:"setting-label"},"Output Variable",-1)),a("div",Z,[v(a("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":t[8]||(t[8]=e=>s.data.output_variable=e),placeholder:"transformed_result",onChange:t[9]||(t[9]=e=>u("output_variable",s.data.output_variable))},null,544),[[c,s.data.output_variable]])]),t[20]||(t[20]=a("div",{class:"setting-help"},"Variable name to store the transformation result",-1))])])):(n(),o("div",_,[a("div",tt,[a("span",et,i(s.data.input_variable||"?"),1),t[21]||(t[21]=a("span",{class:"transform-arrow"},"→",-1)),a("span",at,i(B(s.data.transformation).label),1),t[22]||(t[22]=a("span",{class:"transform-arrow"},"→",-1)),a("span",st,i(s.data.output_variable||"?"),1)]),g.value?(n(),o("div",ot," Regex: "+i(s.data.regex||"Not set"),1)):m("",!0),p.value?(n(),o("div",nt," Custom code: "+i(s.data.code?"Set":"Not set"),1)):m("",!0)]))])],2))}},ut=R(lt,[["__scopeId","data-v-c1638e8a"]]);export{ut as default};
